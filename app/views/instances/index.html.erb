<h1>Listing instances</h1>

<table border="1" cellspacing="0" cellpadding="3">
  <tr>
    <th>Instance</th>
    <th>State</th>
    <th>Ec2 state</th>
    <th>System Info</th>
    <th>Ruby Info</th>
    <th>Time stamps</th>
    <th>Farm</th>
	<th>Launch Time</th>
	 
  </tr>

<% @instances.each do |instance| %>
  <tr>
    <td><%=h instance.instance_id %><BR>
	    <%=h instance.farm.ami_id %></td>
    <td><%=h instance.state %></td>
    <td><%=h instance.ec2_state %></td>
	<td><%=h (instance.system_cpu_usage||=0)*100 %>% (<%=h (instance.system_mem_usage||=0) %>K) <BR>
		Top PID: <%=h instance.top_pid %></td>
    <td>PID: <%=h instance.ruby_pid %> (<%= instance.ruby_pid_status %>) <BR>
	    Usage: <%=h (instance.ruby_cpu_usage||=0)*100 %>% (<%=h (instance.ruby_mem_usage||=0) %>K) <BR>
        Executable: <%=h instance.executable %></td>
	<td>Checked In: <%=h instance.status_updated_at %><BR>
		State Change: <%=h instance.state_changed_at %><BR>
		Launched: <%=h instance.launch_time %>	
		</td>
    <td><%=h instance.farm.name %><BR>
    <%=h instance.farm.ami_id %></td>
	<% unless instance.state == 'shutdown' || instance.ec2_state == 'shutting-down' || instance.ec2_state == 'terminated' %>
	<td><%= link_to 'Terminate', terminate_instance_path(instance), :confirm => 'Are you sure?' %></td>
	<% end -%>
  </tr>
<% end %>
</table>

<h2>Instances NOT tracked by Resource manager</h2>

<table border="1" cellpadding="3">
  <tr>
    <th>Instance ID</th>
	<th>AMI ID</th>
    <th>Ec2 state</th>
	<th>Launch Time</th>

  </tr>

<% @rogues.each do |r| %>
  <tr>
    <td><%=h r[:aws_instance_id]%></td>
    <td><%=h r[:aws_image_id]%></td>
    <td><%=h r[:aws_state]%></td>
    <td><%=h r[:aws_launch_time]%></td>

  </tr>
<% end %>
</table>


<br />
